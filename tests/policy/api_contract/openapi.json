{
  "openapi": "3.1.0",
  "info": {
    "title": "B5-C Mission Control API",
    "version": "0.1.0"
  },
  "paths": {
    "/health": {
      "get": {
        "summary": "Health",
        "operationId": "health_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": {
                    "type": "string"
                  },
                  "type": "object",
                  "title": "Response Health Health Get"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/run_status": {
      "get": {
        "summary": "Get Run Status",
        "description": "Read-only endpoint for run status observability via HTTP pull (Heartbeat Pattern).\n\nContract:\n- GET only, no mutation\n- If run_status.json exists \u2192 return JSON\n- If missing \u2192 return default IDLE state\n- No partial JSON ever observed (atomic writes guarantee)\n- No Socket.IO / WebSocket / SSE",
        "operationId": "get_run_status_api_v1_run_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Get Run Status Api V1 Run Status Get"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/identity": {
      "get": {
        "summary": "Identity",
        "description": "Service identity endpoint for topology observability.",
        "operationId": "identity_api_v1_identity_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Identity Api V1 Identity Get"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/meta/datasets": {
      "get": {
        "summary": "Meta Datasets",
        "description": "Read-only endpoint for GUI.\n\nContract:\n- GET only\n- Must not access filesystem during request handling\n- If registries are not preloaded: return 503\n- Deterministic ordering: datasets sorted by id",
        "operationId": "meta_datasets_api_v1_meta_datasets_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetIndex"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/meta/strategies": {
      "get": {
        "summary": "Meta Strategies",
        "description": "Read-only endpoint for GUI.\n\nContract:\n- GET only\n- Must not access filesystem during request handling\n- If registries are not preloaded: return 503\n- Deterministic ordering: strategies sorted by strategy_id; params sorted by name",
        "operationId": "meta_strategies_api_v1_meta_strategies_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StrategyRegistryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/meta/prime": {
      "post": {
        "summary": "Prime Registries",
        "description": "Prime registries cache (explicit trigger).\n\nThis endpoint allows the UI to manually trigger registry loading\nwhen the automatic startup preload fails (e.g., missing files).\n\nReturns detailed feedback about what succeeded/failed.",
        "operationId": "prime_registries_api_v1_meta_prime_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Prime Registries Api V1 Meta Prime Post"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/registry/instruments": {
      "get": {
        "summary": "Registry Instruments",
        "description": "Return list of instrument symbols (keys from instruments config).\n\nContract:\n- Returns simple array of strings, e.g., [\"MNQ\", \"MES\", ...]\n- If instruments config not loaded, returns 503.\n- Must not access filesystem during request handling.",
        "operationId": "registry_instruments_api_v1_registry_instruments_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "type": "string"
                  },
                  "type": "array",
                  "title": "Response Registry Instruments Api V1 Registry Instruments Get"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/registry/datasets": {
      "get": {
        "summary": "Registry Datasets",
        "description": "Return list of dataset IDs (simple strings).\n\nContract:\n- Returns simple array of strings, e.g., [\"None\", \"VX\", \"ZN\", ...]\n- If dataset registry not loaded, returns 503.\n- Must not access filesystem during request handling.",
        "operationId": "registry_datasets_api_v1_registry_datasets_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "type": "string"
                  },
                  "type": "array",
                  "title": "Response Registry Datasets Api V1 Registry Datasets Get"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/registry/strategies": {
      "get": {
        "summary": "Registry Strategies",
        "description": "Return list of strategy IDs (simple strings).\n\nContract:\n- Returns simple array of strings, e.g., [\"s1_v1\", \"s2_v1\", ...]\n- If strategy registry not loaded, returns 503.\n- Must not access filesystem during request handling.",
        "operationId": "registry_strategies_api_v1_registry_strategies_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "type": "string"
                  },
                  "type": "array",
                  "title": "Response Registry Strategies Api V1 Registry Strategies Get"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/readiness/{season}/{dataset_id}/{timeframe}": {
      "get": {
        "summary": "Readiness Check",
        "description": "Check if bars and features are ready for a given season, dataset, and timeframe.\n\nContract:\n- Returns readiness status without performing any writes.\n- If bars/features files exist, returns paths (relative to outputs root).\n- If missing, returns false with optional error.\n- Must not construct filesystem paths in UI; UI must call this endpoint.",
        "operationId": "readiness_check_api_v1_readiness__season___dataset_id___timeframe__get",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          },
          {
            "name": "dataset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Dataset Id"
            }
          },
          {
            "name": "timeframe",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Timeframe"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReadinessResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs": {
      "get": {
        "summary": "List Jobs Endpoint",
        "operationId": "list_jobs_endpoint_api_v1_jobs_get",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 50,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/JobListResponse"
                  },
                  "title": "Response List Jobs Endpoint Api V1 Jobs Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Submit Job Endpoint",
        "description": "Create a job.\n\nBackward compatible body formats:\n1) Legacy: POST a JobSpec as flat JSON fields\n2) Wrapped: {\"spec\": <JobSpec>}",
        "operationId": "submit_job_endpoint_api_v1_jobs_post",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": true,
                "title": "Payload"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Submit Job Endpoint Api V1 Jobs Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}": {
      "get": {
        "summary": "Get Job Endpoint",
        "operationId": "get_job_endpoint_api_v1_jobs__job_id__get",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JobListResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}/stop": {
      "post": {
        "summary": "Stop Job Endpoint",
        "operationId": "stop_job_endpoint_api_v1_jobs__job_id__stop_post",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          },
          {
            "name": "mode",
            "in": "query",
            "required": false,
            "schema": {
              "$ref": "#/components/schemas/StopMode",
              "default": "SOFT"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Stop Job Endpoint Api V1 Jobs  Job Id  Stop Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}/pause": {
      "post": {
        "summary": "Pause Job Endpoint",
        "operationId": "pause_job_endpoint_api_v1_jobs__job_id__pause_post",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": true,
                "title": "Payload"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Pause Job Endpoint Api V1 Jobs  Job Id  Pause Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}/preflight": {
      "get": {
        "summary": "Preflight Endpoint",
        "operationId": "preflight_endpoint_api_v1_jobs__job_id__preflight_get",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PreflightResult"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}/check": {
      "post": {
        "summary": "Check Job Endpoint",
        "description": "Check a job spec (preflight).\nContract:\n- Exists and returns 200 for valid job_id",
        "operationId": "check_job_endpoint_api_v1_jobs__job_id__check_post",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PreflightResult"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}/run_log_tail": {
      "get": {
        "summary": "Run Log Tail Endpoint",
        "operationId": "run_log_tail_endpoint_api_v1_jobs__job_id__run_log_tail_get",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          },
          {
            "name": "n",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 200,
              "title": "N"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Run Log Tail Endpoint Api V1 Jobs  Job Id  Run Log Tail Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}/log_tail": {
      "get": {
        "summary": "Log Tail Endpoint",
        "description": "Return last n lines of the job log.\n\nContract expected by tests:\n- Uses run_log_path(outputs_root, season, job_id)\n- Returns 200 even if log file missing",
        "operationId": "log_tail_endpoint_api_v1_jobs__job_id__log_tail_get",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          },
          {
            "name": "n",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 200,
              "title": "N"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Log Tail Endpoint Api V1 Jobs  Job Id  Log Tail Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}/artifacts": {
      "get": {
        "summary": "Get Artifacts Index",
        "description": "Return artifact index for a job (Phase C evidence bundle).\n\nContract:\n- job_id must exist in jobs DB (404 if not)\n- Evidence directory must exist (may be empty)\n- Links include reveal_evidence_url, stdout_tail_url, policy_check_url, strategy_report_v1_url (null)\n- Files list includes all files under outputs/jobs/<job_id>/",
        "operationId": "get_artifacts_index_api_v1_jobs__job_id__artifacts_get",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ArtifactIndexResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}/artifacts/{filename}": {
      "get": {
        "summary": "Get Artifact File",
        "description": "Serve a single artifact file from the job evidence directory.\n\nSecurity:\n- filename must be a simple basename (no slashes, no path traversal)\n- Must enforce containment within outputs/jobs/<job_id>/\n- Returns 404 if file not found, 403 if path traversal detected.",
        "operationId": "get_artifact_file_api_v1_jobs__job_id__artifacts__filename__get",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          },
          {
            "name": "filename",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Filename"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}/logs/stdout_tail": {
      "get": {
        "summary": "Stdout Tail Endpoint",
        "description": "Return last n lines of the job's stdout log (from evidence bundle).\n\nContract:\n- If stdout.log exists in evidence directory, return its tail.\n- If not, fallback to run_log_tail (legacy).\n- Returns 200 even if log file missing.",
        "operationId": "stdout_tail_endpoint_api_v1_jobs__job_id__logs_stdout_tail_get",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          },
          {
            "name": "n",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 200,
              "title": "N"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Stdout Tail Endpoint Api V1 Jobs  Job Id  Logs Stdout Tail Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}/reveal_evidence_path": {
      "get": {
        "summary": "Reveal Evidence Path",
        "description": "Return the absolute path to the job evidence directory after containment check.\n\nSecurity:\n- Must ensure job_id does not contain path traversal.\n- Must ensure the resolved path is within the locked evidence root (outputs/jobs/).\n- Returns 404 if evidence directory does not exist.",
        "operationId": "reveal_evidence_path_api_v1_jobs__job_id__reveal_evidence_path_get",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevealEvidencePathResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/{job_id}/report_link": {
      "get": {
        "summary": "Get Report Link Endpoint",
        "description": "Get report_link for a job.\n\nPhase 6 rule: Always return Viewer URL if run_id exists.\nViewer will handle missing/invalid artifacts gracefully.\n\nReturns:\n    - ok: Always True if job exists\n    - report_link: Report link URL (always present if run_id exists)",
        "operationId": "get_report_link_endpoint_api_v1_jobs__job_id__report_link_get",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Get Report Link Endpoint Api V1 Jobs  Job Id  Report Link Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/jobs/batch": {
      "post": {
        "summary": "Batch Submit Endpoint",
        "description": "Submit a batch of jobs.\n\nFlow:\n1) Validate request jobs list not empty and <= cap\n2) Compute batch_id\n3) For each JobSpec in order: call existing \"submit_job\" internal function used by POST /jobs\n4) return response model (200)",
        "operationId": "batch_submit_endpoint_api_v1_jobs_batch_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BatchSubmitRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchSubmitResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/batches/{batch_id}/status": {
      "get": {
        "summary": "Get Batch Status",
        "description": "Get batch execution status (read-only).",
        "operationId": "get_batch_status_api_v1_batches__batch_id__status_get",
        "parameters": [
          {
            "name": "batch_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Batch Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchStatusResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/batches/{batch_id}/summary": {
      "get": {
        "summary": "Get Batch Summary",
        "description": "Get batch summary (read-only).",
        "operationId": "get_batch_summary_api_v1_batches__batch_id__summary_get",
        "parameters": [
          {
            "name": "batch_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Batch Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchSummaryResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/batches/{batch_id}/retry": {
      "post": {
        "summary": "Retry Batch",
        "description": "Retry failed jobs in a batch.",
        "operationId": "retry_batch_api_v1_batches__batch_id__retry_post",
        "parameters": [
          {
            "name": "batch_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Batch Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BatchRetryRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  },
                  "title": "Response Retry Batch Api V1 Batches  Batch Id  Retry Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/batches/{batch_id}/index": {
      "get": {
        "summary": "Get Batch Index",
        "description": "Get batch index.json (read-only).",
        "operationId": "get_batch_index_api_v1_batches__batch_id__index_get",
        "parameters": [
          {
            "name": "batch_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Batch Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Get Batch Index Api V1 Batches  Batch Id  Index Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/batches/{batch_id}/artifacts": {
      "get": {
        "summary": "Get Batch Artifacts",
        "description": "List artifacts tree for a batch (read-only).",
        "operationId": "get_batch_artifacts_api_v1_batches__batch_id__artifacts_get",
        "parameters": [
          {
            "name": "batch_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Batch Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Get Batch Artifacts Api V1 Batches  Batch Id  Artifacts Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/batches/{batch_id}/metadata": {
      "get": {
        "summary": "Get Batch Metadata",
        "description": "Get batch metadata.",
        "operationId": "get_batch_metadata_api_v1_batches__batch_id__metadata_get",
        "parameters": [
          {
            "name": "batch_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Batch Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchMetadata"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update Batch Metadata",
        "description": "Update batch metadata (enforcing frozen rules).",
        "operationId": "update_batch_metadata_api_v1_batches__batch_id__metadata_patch",
        "parameters": [
          {
            "name": "batch_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Batch Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BatchMetadataUpdate"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchMetadata"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/batches/{batch_id}/freeze": {
      "post": {
        "summary": "Freeze Batch",
        "description": "Freeze a batch (irreversible).",
        "operationId": "freeze_batch_api_v1_batches__batch_id__freeze_post",
        "parameters": [
          {
            "name": "batch_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Batch Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  },
                  "title": "Response Freeze Batch Api V1 Batches  Batch Id  Freeze Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/seasons/{season}/index": {
      "get": {
        "summary": "Get Season Index",
        "description": "Get season_index.json (read-only).",
        "operationId": "get_season_index_api_v1_seasons__season__index_get",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Get Season Index Api V1 Seasons  Season  Index Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/seasons/{season}/rebuild_index": {
      "post": {
        "summary": "Rebuild Season Index",
        "description": "Rebuild season index (controlled mutation).\n- Reads artifacts/* metadata/index/summary (read-only)\n- Writes season_index/{season}/season_index.json (atomic)\n- If season is frozen -> 403",
        "operationId": "rebuild_season_index_api_v1_seasons__season__rebuild_index_post",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Rebuild Season Index Api V1 Seasons  Season  Rebuild Index Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/seasons/{season}/metadata": {
      "get": {
        "summary": "Get Season Metadata",
        "description": "Get season metadata.",
        "operationId": "get_season_metadata_api_v1_seasons__season__metadata_get",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Get Season Metadata Api V1 Seasons  Season  Metadata Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update Season Metadata",
        "description": "Update season metadata (controlled mutation).\nFrozen rules:\n- cannot unfreeze a frozen season\n- tags/note allowed",
        "operationId": "update_season_metadata_api_v1_seasons__season__metadata_patch",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SeasonMetadataUpdate"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Update Season Metadata Api V1 Seasons  Season  Metadata Patch"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/seasons/{season}/freeze": {
      "post": {
        "summary": "Freeze Season",
        "description": "Freeze a season (irreversible).",
        "operationId": "freeze_season_api_v1_seasons__season__freeze_post",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Freeze Season Api V1 Seasons  Season  Freeze Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/seasons/{season}/compare/topk": {
      "get": {
        "summary": "Season Compare Topk",
        "description": "Cross-batch TopK for a season (read-only).\n- Reads season_index/{season}/season_index.json\n- Reads artifacts/{batch_id}/summary.json for each batch\n- Missing/corrupt summaries are skipped (never 500 the whole season)",
        "operationId": "season_compare_topk_api_v1_seasons__season__compare_topk_get",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          },
          {
            "name": "k",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 20,
              "title": "K"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Season Compare Topk Api V1 Seasons  Season  Compare Topk Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/seasons/{season}/compare/batches": {
      "get": {
        "summary": "Season Compare Batches",
        "description": "Batch-level compare cards for a season (read-only).\nSource of truth:\n  - season_index/{season}/season_index.json\n  - artifacts/{batch_id}/summary.json (best-effort)",
        "operationId": "season_compare_batches_api_v1_seasons__season__compare_batches_get",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Season Compare Batches Api V1 Seasons  Season  Compare Batches Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/seasons/{season}/compare/leaderboard": {
      "get": {
        "summary": "Season Compare Leaderboard",
        "description": "Grouped leaderboard for a season (read-only).\ngroup_by: strategy_id | dataset_id\nper_group: keep top N items per group",
        "operationId": "season_compare_leaderboard_api_v1_seasons__season__compare_leaderboard_get",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          },
          {
            "name": "group_by",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "default": "strategy_id",
              "title": "Group By"
            }
          },
          {
            "name": "per_group",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 3,
              "title": "Per Group"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Season Compare Leaderboard Api V1 Seasons  Season  Compare Leaderboard Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/seasons/{season}/export": {
      "post": {
        "summary": "Export Season",
        "description": "Export a frozen season into outputs/exports/seasons/{season}/ (controlled mutation).\nRequirements:\n  - season must be frozen (403 if not)\n  - season_index must exist (404 if missing)",
        "operationId": "export_season_api_v1_seasons__season__export_post",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Export Season Api V1 Seasons  Season  Export Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/exports/seasons/{season}/compare/topk": {
      "get": {
        "summary": "Export Season Compare Topk",
        "description": "Cross-batch TopK from exported season package (read-only).\n- Reads exports/seasons/{season}/replay_index.json\n- Does NOT require artifacts/ directory\n- Missing/corrupt summaries are skipped (never 500 the whole season)",
        "operationId": "export_season_compare_topk_api_v1_exports_seasons__season__compare_topk_get",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          },
          {
            "name": "k",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 20,
              "title": "K"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Export Season Compare Topk Api V1 Exports Seasons  Season  Compare Topk Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/exports/seasons/{season}/compare/batches": {
      "get": {
        "summary": "Export Season Compare Batches",
        "description": "Batch-level compare cards from exported season package (read-only).\n- Reads exports/seasons/{season}/replay_index.json\n- Does NOT require artifacts/ directory",
        "operationId": "export_season_compare_batches_api_v1_exports_seasons__season__compare_batches_get",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Export Season Compare Batches Api V1 Exports Seasons  Season  Compare Batches Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/exports/seasons/{season}/compare/leaderboard": {
      "get": {
        "summary": "Export Season Compare Leaderboard",
        "description": "Grouped leaderboard from exported season package (read-only).\n- Reads exports/seasons/{season}/replay_index.json\n- Does NOT require artifacts/ directory",
        "operationId": "export_season_compare_leaderboard_api_v1_exports_seasons__season__compare_leaderboard_get",
        "parameters": [
          {
            "name": "season",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Season"
            }
          },
          {
            "name": "group_by",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "default": "strategy_id",
              "title": "Group By"
            }
          },
          {
            "name": "per_group",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 3,
              "title": "Per Group"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Export Season Compare Leaderboard Api V1 Exports Seasons  Season  Compare Leaderboard Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/datasets/snapshots": {
      "get": {
        "summary": "List Snapshots",
        "description": "List all snapshots (read\u2011only).\n\nReturns:\n    {\n        \"snapshots\": [\n            {\n                \"snapshot_id\": \"...\",\n                \"symbol\": \"...\",\n                \"timeframe\": \"...\",\n                \"created_at\": \"...\",\n                \"raw_sha256\": \"...\",\n                \"normalized_sha256\": \"...\",\n                \"manifest_sha256\": \"...\",\n            },\n            ...\n        ]\n    }",
        "operationId": "list_snapshots_api_v1_datasets_snapshots_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response List Snapshots Api V1 Datasets Snapshots Get"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create Snapshot Endpoint",
        "description": "Create a deterministic snapshot from raw bars.\n\nContract:\n- Input: raw bars (list of dicts) + symbol + timeframe + optional transform_version\n- Deterministic: same input \u2192 same snapshot_id and normalized_sha256\n- Immutable: snapshot directory is write\u2011once (atomic temp\u2011file replace)\n- Timezone\u2011aware: uses UTC timestamps (datetime.now(timezone.utc))\n- Returns SnapshotMetadata with raw_sha256, normalized_sha256, manifest_sha256 chain",
        "operationId": "create_snapshot_endpoint_api_v1_datasets_snapshots_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SnapshotCreatePayload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SnapshotMetadata"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/datasets/registry/register_snapshot": {
      "post": {
        "summary": "Register Snapshot Endpoint",
        "description": "Register an existing snapshot as a dataset (controlled mutation).\n\nContract:\n- snapshot_id must exist under snapshots root\n- Dataset registry is append\u2011only (no overwrites)\n- Conflict detection: if snapshot already registered \u2192 409\n- Returns dataset_id (deterministic) and registry entry",
        "operationId": "register_snapshot_endpoint_api_v1_datasets_registry_register_snapshot_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Register Snapshot Endpoint Api V1 Datasets Registry Register Snapshot Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/portfolio/plans": {
      "get": {
        "summary": "List Portfolio Plans",
        "description": "List all portfolio plans (read\u2011only).\n\nReturns:\n    {\n        \"plans\": [\n            {\n                \"plan_id\": \"...\",\n                \"generated_at_utc\": \"...\",\n                \"source\": {...},\n                \"config\": {...},\n                \"summaries\": {...},\n                \"checksums\": {...},\n            },\n            ...\n        ]\n    }",
        "operationId": "list_portfolio_plans_api_v1_portfolio_plans_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response List Portfolio Plans Api V1 Portfolio Plans Get"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create Portfolio Plan",
        "description": "Create a deterministic portfolio plan from an export (controlled mutation).\n\nContract:\n- Read\u2011only over exports tree (no artifacts, no engine)\n- Deterministic tie\u2011break ordering\n- Controlled mutation: writes only under outputs/portfolio/plans/{plan_id}/\n- Hash chain audit (plan_manifest.json with self\u2011hash)\n- Idempotent: if plan already exists, returns existing plan (200).\n- Returns full plan (including weights, summary, constraints report)",
        "operationId": "create_portfolio_plan_api_v1_portfolio_plans_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PlanCreatePayload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioPlan"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/portfolio/plans/{plan_id}": {
      "get": {
        "summary": "Get Portfolio Plan",
        "description": "Get a portfolio plan by ID (read\u2011only).\n\nReturns:\n    Full portfolio_plan.json content (including universe, weights, summaries).",
        "operationId": "get_portfolio_plan_api_v1_portfolio_plans__plan_id__get",
        "parameters": [
          {
            "name": "plan_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Plan Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Get Portfolio Plan Api V1 Portfolio Plans  Plan Id  Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/worker/status": {
      "get": {
        "summary": "Worker Status",
        "description": "Get worker daemon status (read\u2011only).\n\nReturns:\n    - alive: bool (worker process is alive and responsive)\n    - pid: int or None\n    - last_heartbeat_age_sec: float or None (seconds since last heartbeat)\n    - reason: str (diagnostic message)\n    - expected_db: str (database path worker is attached to)\n    - can_spawn: bool (whether worker can be spawned according to policy)\n    - spawn_reason: str (if can_spawn is False, explains why)\n\nSafety Contract:\n- Never kills or modifies worker state\n- Read\u2011only: only checks pidfile, heartbeat, process existence\n- Returns 200 even if worker is dead (alive: false)\n- Worker daemon is never killed by default",
        "operationId": "worker_status_api_v1_worker_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Worker Status Api V1 Worker Status Get"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/worker/stop": {
      "post": {
        "summary": "Worker Stop",
        "description": "Emergency stop worker daemon (controlled mutation).\n\nSafety Contract:\n- Must validate worker is alive before attempting stop\n- Must validate worker belongs to this control API instance (pidfile validation)\n- Must NOT kill worker if there are active jobs (unless force=True)\n- Must clean up pidfile and heartbeat file after successful stop\n- Returns detailed status of what was stopped\n\nValidation Rules:\n1. Worker must be alive (alive: true in status)\n2. Worker must belong to this control API (pidfile validation passes)\n3. If force=False, check for active jobs (jobs with status RUNNING)\n4. If active jobs exist and force=False \u2192 409 Conflict\n5. If validation passes, send SIGTERM, wait up to 5s, then SIGKILL if needed\n6. Clean up pidfile and heartbeat file after stop\n\nReturns:\n    - stopped: bool (whether worker was stopped)\n    - pid: int or None\n    - signal: str (TERM or KILL)\n    - active_jobs_count: int (number of active jobs at time of stop)\n    - force_used: bool (whether force=True was required)\n    - cleanup_performed: bool (whether pidfile/heartbeat were cleaned up)",
        "operationId": "worker_stop_api_v1_worker_stop_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WorkerStopRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Worker Stop Api V1 Worker Stop Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/portfolio/plans/{plan_id}/quality": {
      "get": {
        "summary": "Get Plan Quality",
        "description": "Compute quality metrics for a portfolio plan (read\u2011only).\n\nContract:\n- Zero\u2011write: only reads plan package files, never writes\n- Deterministic: same plan \u2192 same quality report\n- Returns PlanQualityReport with grade (GREEN/YELLOW/RED) and reasons",
        "operationId": "get_plan_quality_api_v1_portfolio_plans__plan_id__quality_get",
        "parameters": [
          {
            "name": "plan_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Plan Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PlanQualityReport"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Write Plan Quality",
        "description": "Compute quality metrics and write quality files (controlled mutation).\n\nContract:\n- Read\u2011only over plan package files\n- Controlled mutation: writes only three files under plan_dir:\n    - plan_quality.json\n    - plan_quality_checksums.json\n    - plan_quality_manifest.json\n- Idempotent: identical content \u2192 no mtime change\n- Returns PlanQualityReport (same as GET endpoint)",
        "operationId": "write_plan_quality_api_v1_portfolio_plans__plan_id__quality_post",
        "parameters": [
          {
            "name": "plan_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Plan Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PlanQualityReport"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/reports/strategy/{job_id}": {
      "get": {
        "summary": "Get Strategy Report V1",
        "description": "Return precomputed StrategyReportV1 JSON for a job.\n\nContract:\n- If outputs/jobs/<job_id>/strategy_report_v1.json exists:\n  - return its JSON content with application/json\n- Else:\n  - 404 with clear message: \"strategy_report_v1.json not found; run job or upgrade workers\"\n- No heavy compute inside request handler.",
        "operationId": "get_strategy_report_v1_api_v1_reports_strategy__job_id__get",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StrategyReportV1"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/reports/portfolio/{portfolio_id}": {
      "get": {
        "summary": "Get Portfolio Report V1",
        "description": "Return precomputed PortfolioReportV1 JSON for a portfolio admission.\n\nContract:\n- If outputs/portfolios/<portfolio_id>/admission/portfolio_report_v1.json exists:\n  - return its JSON content with application/json\n- Else:\n  - 404 with clear message: \"portfolio_report_v1.json not found; run portfolio build or upgrade workers\"\n- No heavy compute inside request handler.",
        "operationId": "get_portfolio_report_v1_api_v1_reports_portfolio__portfolio_id__get",
        "parameters": [
          {
            "name": "portfolio_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Portfolio Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioReportV1"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/outputs/summary": {
      "get": {
        "summary": "Get Outputs Summary",
        "description": "Return a human-usable summary of outputs (jobs and portfolios) for clean UI navigation.\n\nContract:\n- Version 1.0 schema\n- No filesystem scanning (use supervisor job store)\n- No filesystem paths returned\n- Dumb client: UI must use this endpoint, not scan filesystem",
        "operationId": "get_outputs_summary_api_v1_outputs_summary_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Get Outputs Summary Api V1 Outputs Summary Get"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/portfolios/build": {
      "post": {
        "tags": [
          "portfolios"
        ],
        "summary": "Post Portfolio Build",
        "description": "Submit a portfolio build request.\n\nCreates a BUILD_PORTFOLIO_V2 job and returns job_id immediately.\nThe portfolio_id may be null initially and will be discoverable from job evidence.",
        "operationId": "post_portfolio_build_api_v1_portfolios_build_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PortfolioBuildRequestV1"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioBuildResponseV1"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/portfolios/{portfolio_id}": {
      "get": {
        "tags": [
          "portfolios"
        ],
        "summary": "Get Portfolio",
        "description": "Get basic portfolio metadata.\n\nReturns portfolio ID, creation timestamp (if available), and URLs to\nreport and artifacts.",
        "operationId": "get_portfolio_api_v1_portfolios__portfolio_id__get",
        "parameters": [
          {
            "name": "portfolio_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Portfolio Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioResponseV1"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/portfolios/{portfolio_id}/artifacts": {
      "get": {
        "tags": [
          "portfolios"
        ],
        "summary": "Get Portfolio Artifacts",
        "description": "Get artifact index for a portfolio admission.\n\nLists all files under outputs/portfolios/<portfolio_id>/admission/\nwith metadata and download URLs.",
        "operationId": "get_portfolio_artifacts_api_v1_portfolios__portfolio_id__artifacts_get",
        "parameters": [
          {
            "name": "portfolio_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Portfolio Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PortfolioArtifactsResponseV1"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/portfolios/{portfolio_id}/artifacts/{filename}": {
      "get": {
        "tags": [
          "portfolios"
        ],
        "summary": "Get Portfolio Artifact File",
        "description": "Serve a single artifact file from the portfolio admission directory.\n\nSecurity:\n- filename must be a simple basename (no slashes, no path traversal) -> 403\n- Must enforce containment within outputs/portfolios/<portfolio_id>/admission/ -> 403\n- Returns 404 if file not found (valid basename but missing)\n- Returns 404 if admission directory does not exist (portfolio unknown)",
        "operationId": "get_portfolio_artifact_file_api_v1_portfolios__portfolio_id__artifacts__filename__get",
        "parameters": [
          {
            "name": "portfolio_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Portfolio Id"
            }
          },
          {
            "name": "filename",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Filename"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/portfolios/{portfolio_id}/reveal_admission_path": {
      "get": {
        "tags": [
          "portfolios"
        ],
        "summary": "Reveal Portfolio Admission Path",
        "description": "Return the absolute path to the portfolio admission directory after containment check.\n\nSecurity:\n- Must ensure portfolio_id does not contain path traversal.\n- Must ensure the resolved path is within the locked evidence root (outputs/portfolios/).\n- Returns 404 if admission directory does not exist.",
        "operationId": "reveal_portfolio_admission_path_api_v1_portfolios__portfolio_id__reveal_admission_path_get",
        "parameters": [
          {
            "name": "portfolio_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Portfolio Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevealAdmissionPathResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "ArtifactFile": {
        "properties": {
          "filename": {
            "type": "string",
            "title": "Filename",
            "description": "Filename (relative path)"
          },
          "size_bytes": {
            "type": "integer",
            "title": "Size Bytes",
            "description": "File size in bytes"
          },
          "content_type": {
            "type": "string",
            "title": "Content Type",
            "description": "MIME type"
          },
          "sha256": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Sha256",
            "description": "SHA256 hash (null if not computed)"
          },
          "url": {
            "type": "string",
            "title": "Url",
            "description": "URL to download the file"
          }
        },
        "type": "object",
        "required": [
          "filename",
          "size_bytes",
          "content_type",
          "url"
        ],
        "title": "ArtifactFile",
        "description": "File entry in artifacts index."
      },
      "ArtifactIndexResponse": {
        "properties": {
          "job_id": {
            "type": "string",
            "title": "Job Id"
          },
          "links": {
            "additionalProperties": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ]
            },
            "type": "object",
            "title": "Links"
          },
          "files": {
            "items": {
              "additionalProperties": true,
              "type": "object"
            },
            "type": "array",
            "title": "Files"
          }
        },
        "type": "object",
        "required": [
          "job_id",
          "links",
          "files"
        ],
        "title": "ArtifactIndexResponse",
        "description": "Response for GET /api/v1/jobs/{job_id}/artifacts."
      },
      "BatchMetadata": {
        "properties": {
          "batch_id": {
            "type": "string",
            "title": "Batch Id"
          },
          "season": {
            "type": "string",
            "title": "Season",
            "default": ""
          },
          "tags": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Tags"
          },
          "note": {
            "type": "string",
            "title": "Note",
            "default": ""
          },
          "frozen": {
            "type": "boolean",
            "title": "Frozen",
            "default": false
          },
          "created_at": {
            "type": "string",
            "title": "Created At",
            "default": ""
          },
          "updated_at": {
            "type": "string",
            "title": "Updated At",
            "default": ""
          },
          "created_by": {
            "type": "string",
            "title": "Created By",
            "default": ""
          }
        },
        "type": "object",
        "required": [
          "batch_id"
        ],
        "title": "BatchMetadata"
      },
      "BatchMetadataUpdate": {
        "properties": {
          "season": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Season"
          },
          "tags": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tags"
          },
          "note": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Note"
          },
          "frozen": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Frozen"
          }
        },
        "type": "object",
        "title": "BatchMetadataUpdate",
        "description": "Request for updating batch metadata."
      },
      "BatchRetryRequest": {
        "properties": {
          "force": {
            "type": "boolean",
            "title": "Force",
            "default": false
          }
        },
        "type": "object",
        "title": "BatchRetryRequest",
        "description": "Request for retrying failed jobs in a batch."
      },
      "BatchStatusResponse": {
        "properties": {
          "batch_id": {
            "type": "string",
            "title": "Batch Id"
          },
          "state": {
            "type": "string",
            "title": "State"
          },
          "jobs_total": {
            "type": "integer",
            "title": "Jobs Total",
            "default": 0
          },
          "jobs_done": {
            "type": "integer",
            "title": "Jobs Done",
            "default": 0
          },
          "jobs_failed": {
            "type": "integer",
            "title": "Jobs Failed",
            "default": 0
          }
        },
        "type": "object",
        "required": [
          "batch_id",
          "state"
        ],
        "title": "BatchStatusResponse",
        "description": "Response for batch status."
      },
      "BatchSubmitRequest": {
        "properties": {
          "jobs": {
            "items": {
              "$ref": "#/components/schemas/WizardJobSpec"
            },
            "type": "array",
            "title": "Jobs",
            "description": "List of JobSpec to submit"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "jobs"
        ],
        "title": "BatchSubmitRequest",
        "description": "Request body for batch job submission."
      },
      "BatchSubmitResponse": {
        "properties": {
          "batch_id": {
            "type": "string",
            "title": "Batch Id",
            "description": "Deterministic hash of normalized job list"
          },
          "total_jobs": {
            "type": "integer",
            "title": "Total Jobs",
            "description": "Number of jobs in batch"
          },
          "job_ids": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Job Ids",
            "description": "Job IDs in same order as input jobs"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "batch_id",
          "total_jobs",
          "job_ids"
        ],
        "title": "BatchSubmitResponse",
        "description": "Response for batch job submission."
      },
      "BatchSummaryResponse": {
        "properties": {
          "batch_id": {
            "type": "string",
            "title": "Batch Id"
          },
          "topk": {
            "items": {
              "additionalProperties": true,
              "type": "object"
            },
            "type": "array",
            "title": "Topk",
            "default": []
          },
          "metrics": {
            "additionalProperties": true,
            "type": "object",
            "title": "Metrics",
            "default": {}
          }
        },
        "type": "object",
        "required": [
          "batch_id"
        ],
        "title": "BatchSummaryResponse",
        "description": "Response for batch summary."
      },
      "ConstraintsReport": {
        "properties": {
          "max_per_strategy_truncated": {
            "additionalProperties": {
              "type": "integer"
            },
            "type": "object",
            "title": "Max Per Strategy Truncated"
          },
          "max_per_dataset_truncated": {
            "additionalProperties": {
              "type": "integer"
            },
            "type": "object",
            "title": "Max Per Dataset Truncated"
          },
          "max_weight_clipped": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Max Weight Clipped"
          },
          "min_weight_clipped": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Min Weight Clipped"
          },
          "renormalization_applied": {
            "type": "boolean",
            "title": "Renormalization Applied",
            "default": false
          },
          "renormalization_factor": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Renormalization Factor"
          }
        },
        "type": "object",
        "title": "ConstraintsReport"
      },
      "DataSpec": {
        "properties": {
          "dataset_id": {
            "type": "string",
            "minLength": 1,
            "title": "Dataset Id"
          },
          "start_date": {
            "type": "string",
            "format": "date",
            "title": "Start Date"
          },
          "end_date": {
            "type": "string",
            "format": "date",
            "title": "End Date"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "dataset_id",
          "start_date",
          "end_date"
        ],
        "title": "DataSpec",
        "description": "Dataset specification for a research job."
      },
      "DatasetIndex": {
        "properties": {
          "generated_at": {
            "type": "string",
            "format": "date-time",
            "title": "Generated At",
            "description": "Timestamp when this index was generated"
          },
          "datasets": {
            "items": {
              "$ref": "#/components/schemas/DatasetRecord"
            },
            "type": "array",
            "title": "Datasets",
            "description": "List of all available dataset records"
          }
        },
        "type": "object",
        "required": [
          "generated_at"
        ],
        "title": "DatasetIndex",
        "description": "Complete registry of all available datasets."
      },
      "DatasetRecord": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id",
            "description": "Unique identifier, e.g. 'CME.MNQ.60m.2020-2024'",
            "examples": [
              "CME.MNQ.60m.2020-2024",
              "TWF.MXF.15m.2018-2023"
            ]
          },
          "symbol": {
            "type": "string",
            "title": "Symbol",
            "description": "Symbol identifier, e.g. 'CME.MNQ'",
            "examples": [
              "CME.MNQ",
              "TWF.MXF"
            ]
          },
          "exchange": {
            "type": "string",
            "title": "Exchange",
            "description": "Exchange identifier, e.g. 'CME'",
            "examples": [
              "CME",
              "TWF"
            ]
          },
          "timeframe": {
            "type": "string",
            "title": "Timeframe",
            "description": "Timeframe string, e.g. '60m'",
            "examples": [
              "60m",
              "15m",
              "5m",
              "1D"
            ]
          },
          "path": {
            "type": "string",
            "title": "Path",
            "description": "Relative path to derived file from data/derived/",
            "examples": [
              "CME.MNQ/60m/2020-2024.parquet"
            ]
          },
          "start_date": {
            "type": "string",
            "format": "date",
            "title": "Start Date",
            "description": "First date with data (inclusive)"
          },
          "end_date": {
            "type": "string",
            "format": "date",
            "title": "End Date",
            "description": "Last date with data (inclusive)"
          },
          "fingerprint_sha1": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Fingerprint Sha1",
            "description": "SHA1 hash of file content (binary), deterministic fingerprint (deprecated, use fingerprint_sha256_40)"
          },
          "fingerprint_sha256_40": {
            "type": "string",
            "title": "Fingerprint Sha256 40",
            "description": "SHA256 hash of file content (binary), first 40 hex chars, deterministic fingerprint"
          },
          "tz_provider": {
            "type": "string",
            "title": "Tz Provider",
            "description": "Timezone provider identifier",
            "default": "IANA"
          },
          "tz_version": {
            "type": "string",
            "title": "Tz Version",
            "description": "Timezone database version",
            "default": "unknown"
          }
        },
        "type": "object",
        "required": [
          "id",
          "symbol",
          "exchange",
          "timeframe",
          "path",
          "start_date",
          "end_date",
          "fingerprint_sha256_40"
        ],
        "title": "DatasetRecord",
        "description": "Metadata for a single derived dataset."
      },
      "GovernanceParamsOverrides": {
        "properties": {
          "max_pairwise_correlation": {
            "anyOf": [
              {
                "type": "number",
                "maximum": 1.0,
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Max Pairwise Correlation"
          },
          "portfolio_risk_budget_max": {
            "anyOf": [
              {
                "type": "number",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Portfolio Risk Budget Max"
          }
        },
        "type": "object",
        "title": "GovernanceParamsOverrides",
        "description": "Optional governance parameter overrides."
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "HistogramV1": {
        "properties": {
          "bin_edges": {
            "items": {
              "type": "number"
            },
            "type": "array",
            "title": "Bin Edges"
          },
          "counts": {
            "items": {
              "type": "integer"
            },
            "type": "array",
            "title": "Counts"
          }
        },
        "type": "object",
        "required": [
          "bin_edges",
          "counts"
        ],
        "title": "HistogramV1",
        "description": "Histogram representation with bin edges and counts."
      },
      "JobListResponse": {
        "properties": {
          "job_id": {
            "type": "string",
            "title": "Job Id"
          },
          "type": {
            "type": "string",
            "title": "Type",
            "default": "strategy"
          },
          "status": {
            "type": "string",
            "title": "Status"
          },
          "created_at": {
            "type": "string",
            "title": "Created At"
          },
          "finished_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Finished At"
          },
          "strategy_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Strategy Name"
          },
          "instrument": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Instrument"
          },
          "timeframe": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Timeframe"
          },
          "run_mode": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Run Mode"
          },
          "season": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Season"
          },
          "duration_seconds": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Duration Seconds"
          },
          "score": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Score"
          }
        },
        "type": "object",
        "required": [
          "job_id",
          "status",
          "created_at"
        ],
        "title": "JobListResponse",
        "description": "Response for GET /api/v1/jobs."
      },
      "ParamSpec": {
        "properties": {
          "name": {
            "type": "string",
            "title": "Name",
            "description": "Parameter name (must match strategy implementation)",
            "examples": [
              "window",
              "threshold",
              "enabled"
            ]
          },
          "type": {
            "type": "string",
            "enum": [
              "int",
              "float",
              "enum",
              "bool"
            ],
            "title": "Type",
            "description": "Parameter data type"
          },
          "min": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Min",
            "description": "Minimum value (for int/float types)"
          },
          "max": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Max",
            "description": "Maximum value (for int/float types)"
          },
          "step": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Step",
            "description": "Step size (for int/float sliders)"
          },
          "choices": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Choices",
            "description": "Allowed choices (for enum type)"
          },
          "default": {
            "title": "Default",
            "description": "Default value"
          },
          "help": {
            "type": "string",
            "title": "Help",
            "description": "Human-readable description/help text"
          }
        },
        "type": "object",
        "required": [
          "name",
          "type",
          "default",
          "help"
        ],
        "title": "ParamSpec",
        "description": "Specification for a single strategy parameter.\n\nUsed by GUI to generate appropriate input widgets."
      },
      "PlanCreatePayload": {
        "properties": {
          "season": {
            "type": "string",
            "title": "Season"
          },
          "export_name": {
            "type": "string",
            "title": "Export Name"
          },
          "top_n": {
            "type": "integer",
            "maximum": 500.0,
            "exclusiveMinimum": 0.0,
            "title": "Top N",
            "default": 50
          },
          "max_per_strategy": {
            "type": "integer",
            "maximum": 500.0,
            "exclusiveMinimum": 0.0,
            "title": "Max Per Strategy",
            "default": 100
          },
          "max_per_dataset": {
            "type": "integer",
            "maximum": 500.0,
            "exclusiveMinimum": 0.0,
            "title": "Max Per Dataset",
            "default": 100
          },
          "weighting": {
            "type": "string",
            "enum": [
              "equal",
              "score_weighted",
              "bucket_equal"
            ],
            "title": "Weighting",
            "default": "bucket_equal"
          },
          "bucket_by": {
            "items": {
              "type": "string",
              "enum": [
                "dataset_id",
                "strategy_id"
              ]
            },
            "type": "array",
            "title": "Bucket By"
          },
          "max_weight": {
            "type": "number",
            "maximum": 1.0,
            "exclusiveMinimum": 0.0,
            "title": "Max Weight",
            "default": 0.2
          },
          "min_weight": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Min Weight",
            "default": 0.0
          },
          "enrich_with_batch_api": {
            "type": "boolean",
            "title": "Enrich With Batch Api",
            "default": true
          },
          "enrich_fields": {
            "items": {
              "type": "string",
              "enum": [
                "batch_state",
                "batch_counts",
                "batch_metrics"
              ]
            },
            "type": "array",
            "title": "Enrich Fields"
          },
          "note": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Note"
          }
        },
        "type": "object",
        "required": [
          "season",
          "export_name"
        ],
        "title": "PlanCreatePayload"
      },
      "PlanQualityReport": {
        "properties": {
          "plan_id": {
            "type": "string",
            "title": "Plan Id"
          },
          "generated_at_utc": {
            "type": "string",
            "title": "Generated At Utc"
          },
          "source": {
            "$ref": "#/components/schemas/QualitySourceRef"
          },
          "grade": {
            "type": "string",
            "enum": [
              "GREEN",
              "YELLOW",
              "RED"
            ],
            "title": "Grade"
          },
          "metrics": {
            "$ref": "#/components/schemas/QualityMetrics"
          },
          "reasons": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Reasons"
          },
          "thresholds": {
            "$ref": "#/components/schemas/QualityThresholds"
          },
          "inputs": {
            "additionalProperties": {
              "type": "string"
            },
            "type": "object",
            "title": "Inputs"
          }
        },
        "type": "object",
        "required": [
          "plan_id",
          "generated_at_utc",
          "source",
          "grade",
          "metrics",
          "reasons",
          "thresholds"
        ],
        "title": "PlanQualityReport",
        "description": "Complete quality report for a portfolio plan."
      },
      "PlanSummary": {
        "properties": {
          "total_candidates": {
            "type": "integer",
            "title": "Total Candidates"
          },
          "total_weight": {
            "type": "number",
            "title": "Total Weight"
          },
          "bucket_counts": {
            "additionalProperties": {
              "type": "integer"
            },
            "type": "object",
            "title": "Bucket Counts"
          },
          "bucket_weights": {
            "additionalProperties": {
              "type": "number"
            },
            "type": "object",
            "title": "Bucket Weights"
          },
          "concentration_herfindahl": {
            "type": "number",
            "title": "Concentration Herfindahl"
          },
          "num_selected": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Num Selected"
          },
          "num_buckets": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Num Buckets"
          },
          "bucket_by": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Bucket By"
          },
          "concentration_top1": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Concentration Top1"
          },
          "concentration_top3": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Concentration Top3"
          },
          "bucket_coverage": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Bucket Coverage"
          },
          "bucket_coverage_ratio": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Bucket Coverage Ratio"
          }
        },
        "additionalProperties": true,
        "type": "object",
        "required": [
          "total_candidates",
          "total_weight",
          "concentration_herfindahl"
        ],
        "title": "PlanSummary"
      },
      "PlannedCandidate": {
        "properties": {
          "candidate_id": {
            "type": "string",
            "title": "Candidate Id"
          },
          "strategy_id": {
            "type": "string",
            "title": "Strategy Id"
          },
          "dataset_id": {
            "type": "string",
            "title": "Dataset Id"
          },
          "params": {
            "additionalProperties": true,
            "type": "object",
            "title": "Params"
          },
          "score": {
            "type": "number",
            "title": "Score"
          },
          "season": {
            "type": "string",
            "title": "Season"
          },
          "source_batch": {
            "type": "string",
            "title": "Source Batch"
          },
          "source_export": {
            "type": "string",
            "title": "Source Export"
          },
          "batch_state": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Batch State"
          },
          "batch_counts": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Batch Counts"
          },
          "batch_metrics": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Batch Metrics"
          }
        },
        "type": "object",
        "required": [
          "candidate_id",
          "strategy_id",
          "dataset_id",
          "params",
          "score",
          "season",
          "source_batch",
          "source_export"
        ],
        "title": "PlannedCandidate"
      },
      "PlannedWeight": {
        "properties": {
          "candidate_id": {
            "type": "string",
            "title": "Candidate Id"
          },
          "weight": {
            "type": "number",
            "title": "Weight"
          },
          "reason": {
            "type": "string",
            "title": "Reason"
          }
        },
        "type": "object",
        "required": [
          "candidate_id",
          "weight",
          "reason"
        ],
        "title": "PlannedWeight"
      },
      "PortfolioAdmissionSummaryV1": {
        "properties": {
          "admitted_count": {
            "type": "integer",
            "title": "Admitted Count"
          },
          "rejected_count": {
            "type": "integer",
            "title": "Rejected Count"
          }
        },
        "type": "object",
        "required": [
          "admitted_count",
          "rejected_count"
        ],
        "title": "PortfolioAdmissionSummaryV1",
        "description": "Summary of portfolio admission decisions."
      },
      "PortfolioArtifactsResponseV1": {
        "properties": {
          "portfolio_id": {
            "type": "string",
            "title": "Portfolio Id",
            "description": "Portfolio ID"
          },
          "links": {
            "additionalProperties": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ]
            },
            "type": "object",
            "title": "Links",
            "description": "Named links to key artifacts"
          },
          "files": {
            "items": {
              "$ref": "#/components/schemas/ArtifactFile"
            },
            "type": "array",
            "title": "Files",
            "description": "List of all files"
          }
        },
        "type": "object",
        "required": [
          "portfolio_id",
          "links",
          "files"
        ],
        "title": "PortfolioArtifactsResponseV1",
        "description": "Response for GET /api/v1/portfolios/{portfolio_id}/artifacts."
      },
      "PortfolioBuildRequestV1": {
        "properties": {
          "season": {
            "type": "string",
            "title": "Season",
            "description": "Season identifier (e.g., '2026Q1')"
          },
          "timeframe": {
            "type": "string",
            "title": "Timeframe",
            "description": "Timeframe (e.g., '60m')"
          },
          "candidate_run_ids": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Candidate Run Ids",
            "description": "List of candidate run IDs to include"
          },
          "governance_params_overrides": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/GovernanceParamsOverrides"
              },
              {
                "type": "null"
              }
            ],
            "description": "Optional governance parameter overrides"
          }
        },
        "type": "object",
        "required": [
          "season",
          "timeframe",
          "candidate_run_ids"
        ],
        "title": "PortfolioBuildRequestV1",
        "description": "Request for POST /api/v1/portfolios/build."
      },
      "PortfolioBuildResponseV1": {
        "properties": {
          "job_id": {
            "type": "string",
            "title": "Job Id",
            "description": "Job ID for the portfolio build"
          },
          "portfolio_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Portfolio Id",
            "description": "Portfolio ID (may be null initially)"
          },
          "status": {
            "type": "string",
            "title": "Status",
            "description": "Job status (PENDING, RUNNING, etc.)"
          }
        },
        "type": "object",
        "required": [
          "job_id",
          "status"
        ],
        "title": "PortfolioBuildResponseV1",
        "description": "Response for POST /api/v1/portfolios/build."
      },
      "PortfolioCorrelationV1": {
        "properties": {
          "labels": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Labels"
          },
          "matrix": {
            "items": {
              "items": {
                "type": "number"
              },
              "type": "array"
            },
            "type": "array",
            "title": "Matrix"
          },
          "violations": {
            "anyOf": [
              {
                "items": {
                  "additionalProperties": true,
                  "type": "object"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Violations"
          }
        },
        "type": "object",
        "required": [
          "labels",
          "matrix"
        ],
        "title": "PortfolioCorrelationV1",
        "description": "Correlation matrix and violations."
      },
      "PortfolioLinksV1": {
        "properties": {
          "admission_decision_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Admission Decision Url"
          },
          "correlation_matrix_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Correlation Matrix Url"
          },
          "correlation_violations_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Correlation Violations Url"
          },
          "risk_budget_snapshot_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Risk Budget Snapshot Url"
          },
          "evidence_bundle_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Evidence Bundle Url"
          }
        },
        "type": "object",
        "title": "PortfolioLinksV1",
        "description": "Links to related resources for a portfolio."
      },
      "PortfolioPlan": {
        "properties": {
          "plan_id": {
            "type": "string",
            "title": "Plan Id"
          },
          "generated_at_utc": {
            "type": "string",
            "title": "Generated At Utc"
          },
          "source": {
            "$ref": "#/components/schemas/SourceRef"
          },
          "config": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/PlanCreatePayload"
              },
              {
                "additionalProperties": true,
                "type": "object"
              }
            ],
            "title": "Config"
          },
          "universe": {
            "items": {
              "$ref": "#/components/schemas/PlannedCandidate"
            },
            "type": "array",
            "title": "Universe"
          },
          "weights": {
            "items": {
              "$ref": "#/components/schemas/PlannedWeight"
            },
            "type": "array",
            "title": "Weights"
          },
          "summaries": {
            "$ref": "#/components/schemas/PlanSummary"
          },
          "constraints_report": {
            "$ref": "#/components/schemas/ConstraintsReport"
          }
        },
        "type": "object",
        "required": [
          "plan_id",
          "generated_at_utc",
          "source",
          "config",
          "universe",
          "weights",
          "summaries",
          "constraints_report"
        ],
        "title": "PortfolioPlan"
      },
      "PortfolioReportV1": {
        "properties": {
          "version": {
            "type": "string",
            "const": "1.0",
            "title": "Version",
            "default": "1.0"
          },
          "portfolio_id": {
            "type": "string",
            "title": "Portfolio Id"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          },
          "parameters": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Parameters"
          },
          "admission_summary": {
            "$ref": "#/components/schemas/PortfolioAdmissionSummaryV1"
          },
          "correlation": {
            "$ref": "#/components/schemas/PortfolioCorrelationV1"
          },
          "risk_budget_steps": {
            "anyOf": [
              {
                "items": {
                  "additionalProperties": true,
                  "type": "object"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Risk Budget Steps"
          },
          "admitted_strategies": {
            "anyOf": [
              {
                "items": {
                  "additionalProperties": true,
                  "type": "object"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Admitted Strategies"
          },
          "rejected_strategies": {
            "anyOf": [
              {
                "items": {
                  "additionalProperties": true,
                  "type": "object"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Rejected Strategies"
          },
          "governance_params_snapshot": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Governance Params Snapshot"
          },
          "links": {
            "$ref": "#/components/schemas/PortfolioLinksV1"
          }
        },
        "type": "object",
        "required": [
          "portfolio_id",
          "created_at",
          "admission_summary",
          "correlation",
          "links"
        ],
        "title": "PortfolioReportV1",
        "description": "Portfolio report v1 payload."
      },
      "PortfolioResponseV1": {
        "properties": {
          "portfolio_id": {
            "type": "string",
            "title": "Portfolio Id",
            "description": "Portfolio ID"
          },
          "created_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Created At",
            "description": "Creation timestamp"
          },
          "admission_report_v1_url": {
            "type": "string",
            "title": "Admission Report V1 Url",
            "description": "URL to portfolio report v1"
          },
          "admission_artifacts_index_url": {
            "type": "string",
            "title": "Admission Artifacts Index Url",
            "description": "URL to portfolio artifacts index"
          }
        },
        "type": "object",
        "required": [
          "portfolio_id",
          "admission_report_v1_url",
          "admission_artifacts_index_url"
        ],
        "title": "PortfolioResponseV1",
        "description": "Response for GET /api/v1/portfolios/{portfolio_id}."
      },
      "PreflightResult": {
        "properties": {
          "action": {
            "type": "string",
            "enum": [
              "PASS",
              "BLOCK",
              "AUTO_DOWNSAMPLE"
            ],
            "title": "Action"
          },
          "reason": {
            "type": "string",
            "title": "Reason"
          },
          "original_subsample": {
            "type": "number",
            "title": "Original Subsample"
          },
          "final_subsample": {
            "type": "number",
            "title": "Final Subsample"
          },
          "estimated_bytes": {
            "type": "integer",
            "title": "Estimated Bytes"
          },
          "estimated_mb": {
            "type": "number",
            "title": "Estimated Mb"
          },
          "mem_limit_mb": {
            "type": "number",
            "title": "Mem Limit Mb"
          },
          "mem_limit_bytes": {
            "type": "integer",
            "title": "Mem Limit Bytes"
          },
          "estimates": {
            "additionalProperties": true,
            "type": "object",
            "title": "Estimates"
          }
        },
        "type": "object",
        "required": [
          "action",
          "reason",
          "original_subsample",
          "final_subsample",
          "estimated_bytes",
          "estimated_mb",
          "mem_limit_mb",
          "mem_limit_bytes",
          "estimates"
        ],
        "title": "PreflightResult"
      },
      "QualityMetrics": {
        "properties": {
          "total_candidates": {
            "type": "integer",
            "title": "Total Candidates"
          },
          "top1": {
            "type": "number",
            "title": "Top1",
            "default": 0.0
          },
          "top3": {
            "type": "number",
            "title": "Top3",
            "default": 0.0
          },
          "top5": {
            "type": "number",
            "title": "Top5",
            "default": 0.0
          },
          "herfindahl": {
            "type": "number",
            "title": "Herfindahl"
          },
          "effective_n": {
            "type": "number",
            "title": "Effective N"
          },
          "bucket_by": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Bucket By"
          },
          "bucket_count": {
            "type": "integer",
            "title": "Bucket Count"
          },
          "bucket_coverage_ratio": {
            "type": "number",
            "title": "Bucket Coverage Ratio",
            "default": 0.0
          },
          "constraints_pressure": {
            "type": "integer",
            "title": "Constraints Pressure",
            "default": 0
          }
        },
        "additionalProperties": true,
        "type": "object",
        "required": [
          "total_candidates",
          "herfindahl",
          "effective_n",
          "bucket_count"
        ],
        "title": "QualityMetrics",
        "description": "Contract goals:\n- Internal grading code historically uses: top1/top3/top5/bucket_coverage_ratio\n- Hardening tests expect: top1_score/effective_n/bucket_coverage\nWe support BOTH via real fields + deterministic properties."
      },
      "QualitySourceRef": {
        "properties": {
          "plan_id": {
            "type": "string",
            "title": "Plan Id"
          },
          "season": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Season"
          },
          "export_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Export Name"
          },
          "export_manifest_sha256": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Export Manifest Sha256"
          },
          "candidates_sha256": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Candidates Sha256"
          }
        },
        "type": "object",
        "required": [
          "plan_id"
        ],
        "title": "QualitySourceRef",
        "description": "Reference to the source of the plan."
      },
      "QualityThresholds": {
        "properties": {
          "min_total_candidates": {
            "type": "integer",
            "title": "Min Total Candidates",
            "default": 10
          },
          "green_top1": {
            "type": "number",
            "title": "Green Top1",
            "default": 0.9
          },
          "yellow_top1": {
            "type": "number",
            "title": "Yellow Top1",
            "default": 0.8
          },
          "red_top1": {
            "type": "number",
            "title": "Red Top1",
            "default": 0.75
          },
          "green_top3": {
            "type": "number",
            "title": "Green Top3",
            "default": 0.85
          },
          "yellow_top3": {
            "type": "number",
            "title": "Yellow Top3",
            "default": 0.75
          },
          "red_top3": {
            "type": "number",
            "title": "Red Top3",
            "default": 0.7
          },
          "green_effective_n": {
            "type": "number",
            "title": "Green Effective N",
            "default": 7.0
          },
          "yellow_effective_n": {
            "type": "number",
            "title": "Yellow Effective N",
            "default": 5.0
          },
          "red_effective_n": {
            "type": "number",
            "title": "Red Effective N",
            "default": 4.0
          },
          "green_bucket_coverage": {
            "type": "number",
            "title": "Green Bucket Coverage",
            "default": 0.9
          },
          "yellow_bucket_coverage": {
            "type": "number",
            "title": "Yellow Bucket Coverage",
            "default": 0.7
          },
          "red_bucket_coverage": {
            "type": "number",
            "title": "Red Bucket Coverage",
            "default": 0.6
          },
          "green_constraints_pressure": {
            "type": "integer",
            "title": "Green Constraints Pressure",
            "default": 0
          },
          "yellow_constraints_pressure": {
            "type": "integer",
            "title": "Yellow Constraints Pressure",
            "default": 1
          },
          "red_constraints_pressure": {
            "type": "integer",
            "title": "Red Constraints Pressure",
            "default": 2
          }
        },
        "type": "object",
        "title": "QualityThresholds",
        "description": "Thresholds for grading."
      },
      "ReadinessResponse": {
        "properties": {
          "season": {
            "type": "string",
            "title": "Season"
          },
          "dataset_id": {
            "type": "string",
            "title": "Dataset Id"
          },
          "timeframe": {
            "type": "string",
            "title": "Timeframe"
          },
          "bars_ready": {
            "type": "boolean",
            "title": "Bars Ready"
          },
          "features_ready": {
            "type": "boolean",
            "title": "Features Ready"
          },
          "bars_path": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Bars Path"
          },
          "features_path": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Features Path"
          },
          "error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error"
          }
        },
        "type": "object",
        "required": [
          "season",
          "dataset_id",
          "timeframe",
          "bars_ready",
          "features_ready"
        ],
        "title": "ReadinessResponse",
        "description": "Response for GET /api/v1/readiness/{season}/{dataset_id}/{timeframe}."
      },
      "RevealAdmissionPathResponse": {
        "properties": {
          "approved": {
            "type": "boolean",
            "title": "Approved",
            "description": "Whether path access is approved"
          },
          "path": {
            "type": "string",
            "title": "Path",
            "description": "Absolute path to admission directory"
          }
        },
        "type": "object",
        "required": [
          "approved",
          "path"
        ],
        "title": "RevealAdmissionPathResponse",
        "description": "Response for GET /api/v1/portfolios/{portfolio_id}/reveal_admission_path."
      },
      "RevealEvidencePathResponse": {
        "properties": {
          "approved": {
            "type": "boolean",
            "title": "Approved"
          },
          "path": {
            "type": "string",
            "title": "Path"
          }
        },
        "type": "object",
        "required": [
          "approved",
          "path"
        ],
        "title": "RevealEvidencePathResponse",
        "description": "Response for GET /api/v1/jobs/{job_id}/reveal_evidence_path."
      },
      "SeasonMetadataUpdate": {
        "properties": {
          "tags": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tags"
          },
          "note": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Note"
          },
          "frozen": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Frozen"
          }
        },
        "type": "object",
        "title": "SeasonMetadataUpdate",
        "description": "Request for updating season metadata."
      },
      "SnapshotCreatePayload": {
        "properties": {
          "raw_bars": {
            "items": {
              "additionalProperties": true,
              "type": "object"
            },
            "type": "array",
            "minItems": 1,
            "title": "Raw Bars",
            "description": "List of raw bar dictionaries with timestamp, open, high, low, close, volume"
          },
          "symbol": {
            "type": "string",
            "minLength": 1,
            "title": "Symbol",
            "description": "Trading symbol (e.g., 'MNQ')"
          },
          "timeframe": {
            "type": "string",
            "minLength": 1,
            "title": "Timeframe",
            "description": "Bar timeframe (e.g., '1m', '5m', '1h')"
          },
          "transform_version": {
            "type": "string",
            "minLength": 1,
            "title": "Transform Version",
            "description": "Version of the normalization algorithm (e.g., 'v1')",
            "default": "v1"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "raw_bars",
          "symbol",
          "timeframe"
        ],
        "title": "SnapshotCreatePayload",
        "description": "Payload for creating a data snapshot from raw bars."
      },
      "SnapshotMetadata": {
        "properties": {
          "snapshot_id": {
            "type": "string",
            "minLength": 1,
            "title": "Snapshot Id",
            "description": "Deterministic snapshot identifier"
          },
          "symbol": {
            "type": "string",
            "minLength": 1,
            "title": "Symbol",
            "description": "Trading symbol"
          },
          "timeframe": {
            "type": "string",
            "minLength": 1,
            "title": "Timeframe",
            "description": "Bar timeframe"
          },
          "transform_version": {
            "type": "string",
            "minLength": 1,
            "title": "Transform Version",
            "description": "Version of the normalization algorithm (e.g., 'v1')"
          },
          "created_at": {
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$",
            "title": "Created At",
            "description": "ISO 8601 UTC timestamp when snapshot was created (may include fractional seconds)"
          },
          "raw_sha256": {
            "type": "string",
            "pattern": "^[a-f0-9]{64}$",
            "title": "Raw Sha256",
            "description": "SHA256 of the raw bars JSON"
          },
          "normalized_sha256": {
            "type": "string",
            "pattern": "^[a-f0-9]{64}$",
            "title": "Normalized Sha256",
            "description": "SHA256 of the normalized bars JSON"
          },
          "manifest_sha256": {
            "type": "string",
            "pattern": "^[a-f0-9]{64}$",
            "title": "Manifest Sha256",
            "description": "SHA256 of the manifest JSON (excluding this field)"
          },
          "stats": {
            "$ref": "#/components/schemas/SnapshotStats",
            "description": "Basic statistics of the snapshot"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "snapshot_id",
          "symbol",
          "timeframe",
          "transform_version",
          "created_at",
          "raw_sha256",
          "normalized_sha256",
          "manifest_sha256",
          "stats"
        ],
        "title": "SnapshotMetadata",
        "description": "Immutable metadata of a data snapshot."
      },
      "SnapshotStats": {
        "properties": {
          "count": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Count",
            "description": "Number of bars"
          },
          "min_timestamp": {
            "type": "string",
            "title": "Min Timestamp",
            "description": "Earliest bar timestamp (ISO 8601 UTC)"
          },
          "max_timestamp": {
            "type": "string",
            "title": "Max Timestamp",
            "description": "Latest bar timestamp (ISO 8601 UTC)"
          },
          "min_price": {
            "type": "number",
            "minimum": 0.0,
            "title": "Min Price",
            "description": "Lowest low price across bars"
          },
          "max_price": {
            "type": "number",
            "minimum": 0.0,
            "title": "Max Price",
            "description": "Highest high price across bars"
          },
          "total_volume": {
            "type": "number",
            "minimum": 0.0,
            "title": "Total Volume",
            "description": "Sum of volume across bars"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "count",
          "min_timestamp",
          "max_timestamp",
          "min_price",
          "max_price",
          "total_volume"
        ],
        "title": "SnapshotStats",
        "description": "Basic statistics of a snapshot."
      },
      "SourceRef": {
        "properties": {
          "season": {
            "type": "string",
            "title": "Season"
          },
          "export_name": {
            "type": "string",
            "title": "Export Name"
          },
          "export_manifest_sha256": {
            "type": "string",
            "title": "Export Manifest Sha256"
          },
          "candidates_sha256": {
            "type": "string",
            "title": "Candidates Sha256"
          },
          "candidates_file_sha256": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Candidates File Sha256"
          },
          "candidates_items_sha256": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Candidates Items Sha256"
          }
        },
        "type": "object",
        "required": [
          "season",
          "export_name",
          "export_manifest_sha256",
          "candidates_sha256"
        ],
        "title": "SourceRef"
      },
      "StopMode": {
        "type": "string",
        "enum": [
          "SOFT",
          "KILL"
        ],
        "title": "StopMode",
        "description": "Stop request mode."
      },
      "StrategyDistributionsV1": {
        "properties": {
          "returns_histogram": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/HistogramV1"
              },
              {
                "type": "null"
              }
            ]
          }
        },
        "type": "object",
        "title": "StrategyDistributionsV1",
        "description": "Distribution data for a strategy."
      },
      "StrategyHeadlineMetricsV1": {
        "properties": {
          "score": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Score"
          },
          "net_profit": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Net Profit"
          },
          "max_drawdown": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Max Drawdown"
          },
          "trades": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Trades"
          },
          "win_rate": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Win Rate"
          },
          "downstream_admissible": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Downstream Admissible"
          }
        },
        "type": "object",
        "title": "StrategyHeadlineMetricsV1",
        "description": "Headline metrics for a strategy run."
      },
      "StrategyLinksV1": {
        "properties": {
          "policy_check_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Policy Check Url"
          },
          "stdout_tail_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Stdout Tail Url"
          },
          "evidence_bundle_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Evidence Bundle Url"
          },
          "artifacts_index_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Artifacts Index Url"
          }
        },
        "type": "object",
        "title": "StrategyLinksV1",
        "description": "Links to related resources for a strategy."
      },
      "StrategyRegistryResponse": {
        "properties": {
          "strategies": {
            "items": {
              "$ref": "#/components/schemas/StrategySpecForGUI"
            },
            "type": "array",
            "title": "Strategies"
          }
        },
        "type": "object",
        "required": [
          "strategies"
        ],
        "title": "StrategyRegistryResponse",
        "description": "Response model for /meta/strategies endpoint."
      },
      "StrategyReportV1": {
        "properties": {
          "version": {
            "type": "string",
            "const": "1.0",
            "title": "Version",
            "default": "1.0"
          },
          "job_id": {
            "type": "string",
            "title": "Job Id"
          },
          "strategy_name": {
            "type": "string",
            "title": "Strategy Name"
          },
          "parameters": {
            "additionalProperties": true,
            "type": "object",
            "title": "Parameters"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          },
          "finished_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Finished At"
          },
          "status": {
            "type": "string",
            "title": "Status"
          },
          "headline_metrics": {
            "$ref": "#/components/schemas/StrategyHeadlineMetricsV1"
          },
          "series": {
            "$ref": "#/components/schemas/StrategySeriesV1"
          },
          "distributions": {
            "$ref": "#/components/schemas/StrategyDistributionsV1"
          },
          "tables": {
            "$ref": "#/components/schemas/StrategyTablesV1"
          },
          "links": {
            "$ref": "#/components/schemas/StrategyLinksV1"
          }
        },
        "type": "object",
        "required": [
          "job_id",
          "strategy_name",
          "parameters",
          "created_at",
          "status",
          "headline_metrics",
          "series",
          "distributions",
          "tables",
          "links"
        ],
        "title": "StrategyReportV1",
        "description": "Strategy report v1 payload."
      },
      "StrategySeriesV1": {
        "properties": {
          "equity": {
            "anyOf": [
              {
                "items": {
                  "$ref": "#/components/schemas/TimePointV1"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Equity"
          },
          "drawdown": {
            "anyOf": [
              {
                "items": {
                  "$ref": "#/components/schemas/TimePointV1"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Drawdown"
          },
          "rolling_metric": {
            "anyOf": [
              {
                "items": {
                  "$ref": "#/components/schemas/TimePointV1"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Rolling Metric"
          },
          "rolling_metric_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Rolling Metric Name"
          }
        },
        "type": "object",
        "title": "StrategySeriesV1",
        "description": "Time series data for a strategy."
      },
      "StrategySpecForGUI": {
        "properties": {
          "strategy_id": {
            "type": "string",
            "title": "Strategy Id"
          },
          "params": {
            "items": {
              "$ref": "#/components/schemas/ParamSpec"
            },
            "type": "array",
            "title": "Params"
          },
          "content_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Content Id"
          }
        },
        "type": "object",
        "required": [
          "strategy_id",
          "params"
        ],
        "title": "StrategySpecForGUI",
        "description": "Strategy specification for GUI consumption.\n\nContains metadata and parameter schema for automatic UI generation.\nGUI must NOT hardcode any strategy parameters."
      },
      "StrategyTablesV1": {
        "properties": {
          "trade_list": {
            "anyOf": [
              {
                "items": {
                  "$ref": "#/components/schemas/TradeRowV1"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Trade List"
          },
          "trade_summary": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Trade Summary"
          }
        },
        "type": "object",
        "title": "StrategyTablesV1",
        "description": "Tabular data for a strategy."
      },
      "TimePointV1": {
        "properties": {
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp"
          },
          "value": {
            "type": "number",
            "title": "Value"
          }
        },
        "type": "object",
        "required": [
          "timestamp",
          "value"
        ],
        "title": "TimePointV1",
        "description": "A timestamp-value pair for time series data."
      },
      "TradeRowV1": {
        "properties": {
          "entry_time": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Entry Time"
          },
          "exit_time": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Exit Time"
          },
          "pnl": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Pnl"
          },
          "mfe": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Mfe"
          },
          "mae": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Mae"
          }
        },
        "type": "object",
        "title": "TradeRowV1",
        "description": "Minimal trade row representation."
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      },
      "WFSSpec": {
        "properties": {
          "stage0_subsample": {
            "type": "number",
            "title": "Stage0 Subsample",
            "default": 1.0
          },
          "top_k": {
            "type": "integer",
            "title": "Top K",
            "default": 100
          },
          "mem_limit_mb": {
            "type": "integer",
            "title": "Mem Limit Mb",
            "default": 4096
          },
          "allow_auto_downsample": {
            "type": "boolean",
            "title": "Allow Auto Downsample",
            "default": true
          }
        },
        "additionalProperties": false,
        "type": "object",
        "title": "WFSSpec",
        "description": "WFS (Winners Funnel System) configuration."
      },
      "WizardJobSpec": {
        "properties": {
          "season": {
            "type": "string",
            "minLength": 1,
            "title": "Season"
          },
          "data1": {
            "$ref": "#/components/schemas/DataSpec"
          },
          "data2": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/DataSpec"
              },
              {
                "type": "null"
              }
            ]
          },
          "strategy_id": {
            "type": "string",
            "minLength": 1,
            "title": "Strategy Id"
          },
          "params": {
            "additionalProperties": true,
            "type": "object",
            "title": "Params"
          },
          "wfs": {
            "$ref": "#/components/schemas/WFSSpec"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": [
          "season",
          "data1",
          "strategy_id"
        ],
        "title": "WizardJobSpec",
        "description": "Complete job specification for research.\n\nPhase 12 Iron Rule: GUI's ONLY output = WizardJobSpec JSON\nMust NOT contain worker/engine runtime state."
      },
      "WorkerStopRequest": {
        "properties": {
          "force": {
            "type": "boolean",
            "title": "Force",
            "default": false
          },
          "reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Reason"
          }
        },
        "type": "object",
        "title": "WorkerStopRequest",
        "description": "Request for emergency worker stop."
      }
    }
  }
}